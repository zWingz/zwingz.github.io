<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="description" content="isPlainObject 判断一个纯对象"><meta name="keywords" content="javascript,plain-object"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><title>isPlainObject 判断一个纯对象 - zWing</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?6650629ba7ddbfe98e2f63700c2e6923";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body><div class="indicator"></div><canvas id="ribbon"></canvas><main class="main"><header class="header"><a class="logo" href="/">zWing</a><nav class="menu"><a href="/archives/">Archives</a><a href="/tags/">Tags</a><a href="/about/">About</a><a href="/repo/">Repo</a></nav><div class="social"><a target="_blank" href="/rss.xml"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.18,15.64A2.18,2.18 0 0,1 8.36,17.82C8.36,19 7.38,20 6.18,20C5,20 4,19 4,17.82A2.18,2.18 0 0,1 6.18,15.64M4,4.44A15.56,15.56 0 0,1 19.56,20H16.73A12.73,12.73 0 0,0 4,7.27V4.44M4,10.1A9.9,9.9 0 0,1 13.9,20H11.07A7.07,7.07 0 0,0 4,12.93V10.1Z"></path></svg> </a><a target="_blank" href="https://github.com/zWingz/my-blog-config/issues"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"></path></svg></a></div></header><div class="content-container center"><div id="post" class="flex"><aside class="toc"><div class="stay"><ul><li><a href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%B8%BA%E5%AF%B9%E8%B1%A1">判断是否为对象</a><ul><li><a href="#typeof">typeof</a></li><li><a href="#objectprototypetostring">Object.prototype.toString</a></li></ul></li><li><a href="#%E5%88%A4%E6%96%AD%E7%BA%AF%E5%AF%B9%E8%B1%A1">判断纯对象</a><ul><li><a href="#%E4%BB%85%E5%8C%85%E6%8B%AC%E5%AD%97%E9%9D%A2%E5%8F%98%E9%87%8F">仅包括字面变量</a></li><li><a href="#%E4%BB%85%E5%8C%85%E6%8B%AC%E5%AD%97%E9%9D%A2%E5%8F%98%E9%87%8F%E4%BB%A5%E5%8F%8Aobjectcreatenull">仅包括字面变量以及Object.create(null)</a></li><li><a href="#%E5%8C%85%E6%8B%AC%E5%AD%97%E9%9D%A2%E5%8F%98%E9%87%8F%E4%BB%A5%E5%8F%8A%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%94%9F%E6%88%90%E7%9A%84%E5%AF%B9%E8%B1%A1">包括字面变量以及构造函数生成的对象</a></li><li><a href="#lodash%E5%AE%9E%E7%8E%B0">lodash实现</a></li></ul></li></ul><span class="toc-icon"></span></div></aside><article class="post-content"><time class="time">April 04, 2019</time><h1 class="title">isPlainObject 判断一个纯对象</h1><div><a href="/tags/819211023" class="tags-item" style="background: #c5def5;">Js </a><a href="/tags/819211154" class="tags-item" style="background: #92efc8;">Front End</a></div><div class="content"><h2 id="判断是否为对象" class="heading"><a href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%B8%BA%E5%AF%B9%E8%B1%A1" aria-hidden="true"><span class="icon icon-link"></span></a>判断是否为对象</h2><p>其实<code class="language-text">js</code>中一切都是对象, 但是这里讨论的对象只是一般对象, 非数组/字符串/方法/等等 形如<code class="language-text">{}</code>, <code class="language-text">Object.create()</code>, <code class="language-text">new AnyClass()</code> 等等</p><h3 id="typeof" class="heading"><a href="#typeof" aria-hidden="true"><span class="icon icon-link"></span></a>typeof</h3><p>通过<code class="language-text">typeof arg === &#39;object&#39;</code>可以得出的是<code class="language-text">arg</code>为<code class="language-text">字面变量</code>/<code class="language-text">null</code>/<code class="language-text">array</code> 因此, 如果要通过<code class="language-text">typeof</code>判断是否为<code class="language-text">object</code>, 则要排除<code class="language-text">null</code>和<code class="language-text">array</code></p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">isObj</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> arg <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> arg <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="objectprototypetostring" class="heading"><a href="#objectprototypetostring" aria-hidden="true"><span class="icon icon-link"></span></a>Object.prototype.toString</h3><p>使用<code class="language-text">toString</code>来判断一个对象, 往往能得到更详细的信息</p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// [object Array]</span>
<span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// [object Function]</span>
<span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// [object Null]</span>
<span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// [object Undefined]</span>
<span class="token comment">// ...</span>
<span class="token comment">// 排除了内置的Date, RegExp等等</span>
</code></pre></div><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">isObj</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'[object Object]'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="判断纯对象" class="heading"><a href="#%E5%88%A4%E6%96%AD%E7%BA%AF%E5%AF%B9%E8%B1%A1" aria-hidden="true"><span class="icon icon-link"></span></a>判断纯对象</h2><p>一般是<code class="language-text">key/value</code>形式的对象 还是要根据实际情况来确定判断方式 主要是对<code class="language-text">Object.create</code>以及<code class="language-text">new AnyClass</code>形式的判断</p><p>使用<code class="language-text">typescript</code>来表示</p><div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">PlainObject</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>k<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="仅包括字面变量" class="heading"><a href="#%E4%BB%85%E5%8C%85%E6%8B%AC%E5%AD%97%E9%9D%A2%E5%8F%98%E9%87%8F" aria-hidden="true"><span class="icon icon-link"></span></a>仅包括字面变量</h3><p>既通过字面变量声明或者<code class="language-text">new Object</code>方式的对象</p><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">isPlainObj</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    value <span class="token operator">&amp;&amp;</span> <span class="token comment">// 排除掉 null</span>
    <span class="token punctuation">(</span><span class="token keyword">typeof</span> value<span class="token punctuation">.</span>constructor <span class="token operator">!==</span> <span class="token string">'function'</span> <span class="token operator">||</span> <span class="token comment">// 除了Object外的一些Class</span>
      value<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'Object'</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">isPlainObj</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token function">isPlainObj</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><h3 id="仅包括字面变量以及objectcreatenull" class="heading"><a href="#%E4%BB%85%E5%8C%85%E6%8B%AC%E5%AD%97%E9%9D%A2%E5%8F%98%E9%87%8F%E4%BB%A5%E5%8F%8Aobjectcreatenull" aria-hidden="true"><span class="icon icon-link"></span></a>仅包括字面变量以及Object.create(null)</h3><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">isPlainObj</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 先判断是否为一般对象</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'[object Object]'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token comment">// 获取原型, 后续判断原型是否为null或者Object</span>
  <span class="token keyword">return</span> prototype <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> prototype <span class="token operator">===</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 相当于 prototype === Object.prototype</span>
<span class="token punctuation">}</span>

<span class="token function">isPlainObj</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token function">isPlainObj</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token function">isPlainObj</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="包括字面变量以及构造函数生成的对象" class="heading"><a href="#%E5%8C%85%E6%8B%AC%E5%AD%97%E9%9D%A2%E5%8F%98%E9%87%8F%E4%BB%A5%E5%8F%8A%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%94%9F%E6%88%90%E7%9A%84%E5%AF%B9%E8%B1%A1" aria-hidden="true"><span class="icon icon-link"></span></a>包括字面变量以及构造函数生成的对象</h3><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// 先判断是否为对象</span>
<span class="token keyword">function</span> <span class="token function">isObjectObject</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token function">isObject</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token operator">&amp;&amp;</span>
    <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Object]'</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">isPlainObject</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ctor<span class="token punctuation">,</span> prot
  <span class="token comment">// 首先是一个对象, 通过typeof和toString判断</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObjectObject</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>

  <span class="token comment">// If has modified constructor</span>
  <span class="token comment">// 判断构造函数是否为function</span>
  ctor <span class="token operator">=</span> o<span class="token punctuation">.</span>constructor
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> ctor <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>

  <span class="token comment">// If has modified prototype</span>
  <span class="token comment">// 判断原型是否也是一个对象</span>
  prot <span class="token operator">=</span> ctor<span class="token punctuation">.</span>prototype
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObjectObject</span><span class="token punctuation">(</span>prot<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>

  <span class="token comment">// If constructor does not have an Object-specific method</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>prot<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'isPrototypeOf'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Most likely a plain Object</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="lodash实现" class="heading"><a href="#lodash%E5%AE%9E%E7%8E%B0" aria-hidden="true"><span class="icon icon-link"></span></a>lodash实现</h3><p><a href="https://github.com/lodash/lodash/blob/master/isPlainObject.js">源码</a></p><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">/**
    isObjectLike就是判断obj !== null &amp;&amp; typeof obj === 'object'
    getTag: 就是拿Object.prototype.toString
*/</span>
<span class="token keyword">function</span> <span class="token function">isPlainObject</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isObjectLike</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">getTag</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'[object Object]'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Object.create(null)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> proto <span class="token operator">=</span> value
  <span class="token comment">// 获取最顶级的proto</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 如果最最顶级proto就是value.prototype, 则为true</span>
  <span class="token comment">// 既Object.prototype</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">===</span> proto
<span class="token punctuation">}</span>
</code></pre></div></div><div class="comments"><div id="gitalk-container"></div></div></article></div></div></main><footer class="footer"><div class="center">Powered by <a target="_blank" href="https://github.com/acyortjs/acyort">AcyOrt</a> / Theme <a target="_blank" href="https://github.com/acyortjs/theme-donob">donob</a></div></footer><script src="/script/post.js"></script><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script>const gitalkConfig = JSON.parse('{"owner":"zWingz","repo":"my-blog-config","admin":["zWingz"],"clientID":"0438ed96c0cb944693a7","clientSecret":"23e7aa3152f5d03d8f20029540741d6f886c9f5b","number":31}')
  var gitalk = new Gitalk({
    ...gitalkConfig
  })
  gitalk.render('gitalk-container')</script><script defer="defer" src="/script/ribbon.js"></script></body></html>